import React, { useEffect, useState } from 'react'; import { api } from '../api'; import RatingStars from '../components/RatingStars'
export default function Onboarding(){
  const [items,setItems]=useState([]); const [ratings,setRatings]=useState({})
  useEffect(()=>{ api.get('/api/places/sample?n=15').then(res=>setItems(res.data)).catch(console.error) },[])
  const submit=async()=>{ const entries=Object.entries(ratings).filter(([pid,r])=>r>0); if(entries.length===0){ alert('Beri minimal 1 rating.'); return } try{ await Promise.all(entries.map(([pid,r])=>api.post('/api/ratings',{place_id:Number(pid),rating:r}))); alert('Terima kasih! Rekomendasi AI siap.'); window.location.href='/home' }catch(e){ alert('Gagal menyimpan rating.') } }
  return (<div><h1 className='text-xl font-semibold mb-4'>Onboarding: Beri rating cepat</h1><div className='grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4'>{items.map(p => (<div key={p.id} className='bg-white rounded-xl shadow-sm p-3'><img src={p.image} className='w-full h-40 object-cover rounded-lg' /><div className='mt-2 font-semibold'>{p.place_name}</div><div className='text-sm text-gray-500'>{p.city} â€¢ {p.category}</div><div className='mt-2'><RatingStars value={ratings[p.id]||0} onChange={v=>setRatings(prev=>({...prev,[p.id]:v}))} /></div></div>))}</div><div className='mt-4'><button onClick={submit} className='px-4 py-2 rounded bg-black text-white'>Simpan & Lihat Rekomendasi</button></div></div>)
}
